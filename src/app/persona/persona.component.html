<div class="container">
  <div class="row">
    <!-- Seria para mostrar una persona   -->
    <main class="post blog-post col-lg-8" >   
      <div *ngIf="!mostrarTodas &&  (personas | filterBy:filtrado ).length == 1 ">
        <div class="post-single" >
          <div *ngFor="let persona of personas | filterBy:filtrado | orderBy:['nombres','apellidos'] ">
            <div class="container">
              <div class="row">
                <div class="post col-xl-6">
                  <div class="post-thumbnail"><img src={{fotoRuta}}{{persona.foto}}  alt="..." class="img-fluid rounded-circle"></div>
                  <div class="post-details"></div>
                </div>
                <div class="post col-xl-6">
                  <div class="post-thumbnail"></div>
                  <div class="post-details">
                    <div class="post-meta d-flex justify-content-between">
                      <h6>Datos personales:</h6>
                    </div>
                      <h3 class="h4">{{persona.nombres | uppercase }}, {{persona.apellidos | uppercase }}</h3>
                      <h5>D.N.I.:{{persona.dni}}</h5>
                      <h5>Título: {{persona.titulos[0]}}  <a href={{curriculumRuta}}{{persona.curriculum}} target="_blank"><i class="fa fa-bookmark-o"></i></a></h5>
                      <div class="date meta-last">Fecha de Inicio: {{persona.fechaInicio | date:'dd/MM/yyyy' }}</div>
                  </div>
                </div>
              </div>
            </div>
            <!--Es lo que explica a la persona.....-->
            <div class="post-body"> 
                <p class="lead">Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
            </div>
            <!--Muestra las excavaciones que Dirige si tiene-->
            <div *ngIf="excaDirige.length > 0">
              <div class="h5" *ngFor="let exca of excaDirige | orderBy:['nombre']"> Excavaciones que Dirige: 
                <br><br>
                <div class="d-flex align-items-center">  
                    <div class="title"><strong>{{exca.nombre | uppercase }}</strong></div>
                    <div ><a (click)="openModal(templateExca)"><i class="icon-clock"></i> Fecha inicio: {{exca.fechaInicio | date:'dd/MM/yyyy'}}
                      <ng-template #templateExca>
                        <div class="modal-header">
                          <h4 class="modal-title pull-left">Exavación Código:{{exca.codigo}}</h4>
                          <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
                            <span aria-hidden="true">&times;</span>
                          </button>
                        </div>
                        <div class="modal-body">
                          <li><strong>Area: </strong>{{exca.area}}</li>
                          <li><strong>Localidad: </strong> {{exca.localidad}} </li>
                          <li><strong>Provincia: </strong>{{exca.provincia}} </li>
                        </div>
                      </ng-template>
                      </a>
                    </div>
                </div>
                <div class="item d-flex align-items-center" >
                  <div class="image" *ngFor="let foto of exca.fotosExcavacion">
                    <a href={{rutaExca}}{{exca._id}}{{foto}} data-fancybox="gallery" class="image">
                    <img src={{rutaExca}}{{exca._id}}{{foto}} alt="..." class="img-fluid"></a>
                  </div>
                </div>
               
                <div class="post-body"> 
                  <p class="lead">{{exca.descripcion}}</p>

                </div>  
              </div>   
            </div>
            <div  class="h5"*ngIf="excaDirige.length == 0">No es Director de ninguna Excavación.</div>
          </div>
        </div> 
      </div> 
      <div *ngIf = "!mostrarTodas && (personas | filterBy:filtrado ).length == 0 "   class="post-body" >
          <p class="lead">La busqueda que planteo para las Personas <strong>no dio</strong> resultado.</p>
          <p>Tenga en cuenta que esta buscando por <strong>Nombres / Apellidos / dni </strong> de la Persona, agregre mas detalle a la busqueda. </p>
      </div>
      <div *ngIf = "!mostrarTodas && (personas | filterBy:filtrado ).length > 1 "   class="post-body" >
          <p class="lead">La busqueda que planteo para las Persona <strong>dio varios </strong> resultadoss.</p>
          <p><strong>Seleccione </strong> una persona de la siguiente lista o realice una nueva busqueda.</p>
          <div *ngFor="let persona of personas | filterBy:filtrado | orderBy:['nombres','apellidos'] ">
              <a (click)="setearFiltro(persona.nombres, persona.apellidos, persona._id)">
                  <h3 class="h4">{{persona.nombres | uppercase }}, {{persona.apellidos | uppercase }}</h3>
              </a>
          </div>
      </div>   
    </main>
    <!-- Muestra las personas Resumidas -->
    <main *ngIf= mostrarTodas class="posts-listing col-lg-8">                 
      <div class="container">
        <div class="row">
          <!-- Persona nro 1 de la pagina -->
          <div *ngIf ="personas?.length >= indicePagina+1" class="post col-xl-6">
            <div class="post-thumbnail"><img src={{fotoRuta}}{{personas[indicePagina]?.foto}}  alt="..." class="img-fluid"></div>
            <div class="post-details">
              <div class="post-meta d-flex justify-content-between">
                <div class="date meta-last">{{personas[(indicePagina)]?.fechaInicio | date:'dd/MM/yyyy' }}</div>
              </div><a (click)="setearFiltro(personas[(indicePagina)]?.nombres, personas[(indicePagina)]?.apellidos,personas[(indicePagina)]?._id)">
                <h3 class="h4">{{personas[(indicePagina)]?.nombres | uppercase }}, {{personas[(indicePagina)]?.apellidos | uppercase }}</h3></a>
              <p class="text-muted">{{personas[(indicePagina)]?.titulos}}</p>
            </div>
          </div>
          <!-- Persona nro 2 de la pagina -->
          <div *ngIf ="personas?.length >=indicePagina+2" class="post col-xl-6">
            <div class="post-thumbnail"><img src={{fotoRuta}}{{personas[indicePagina+1]?.foto}} alt="..." class="img-fluid"></div>
            <div class="post-details">
              <div class="post-meta d-flex justify-content-between">
                <div class="date meta-last">{{personas[indicePagina+1]?.fechaInicio | date:'dd/MM/yyyy' }}</div>
              </div><a (click)="setearFiltro(personas[(indicePagina+1)]?.nombres, personas[(indicePagina+1)]?.apellidos, personas[(indicePagina+1)]?._id)">
                <h3 class="h4">{{personas[indicePagina+1]?.nombres | uppercase }}, {{personas[indicePagina+1]?.apellidos | uppercase }}</h3></a>
              <p class="text-muted">{{personas[indicePagina+1]?.titulos}}</p>
              </div>
          </div>
          <!-- Persona nro 3 de la pagina -->
          <div *ngIf ="personas?.length >=indicePagina+3" class="post col-xl-6">
            <div class="post-thumbnail"><img src={{fotoRuta}}{{personas[indicePagina+2]?.foto}}  alt="..." class="img-fluid"></div>
            <div class="post-details">
              <div class="post-meta d-flex justify-content-between">
                <div class="date meta-last">{{personas[indicePagina+2]?.fechaInicio | date:'dd/MM/yyyy' }}</div>
              </div><a (click)="setearFiltro(personas[(indicePagina+2)]?.nombres, personas[(indicePagina+2)]?.apellidos,personas[(indicePagina+2)]?._id)"> 
                <h3 class="h4">{{personas[indicePagina+2]?.nombres | uppercase }},{{personas[indicePagina+2]?.apellidos | uppercase }} </h3></a>
              <p class="text-muted">{{personas[indicePagina+2]?.titulos}}</p>
            </div>
          </div>
          <!-- Persona nro 4 de la pagina -->
          <div *ngIf ="personas?.length >=indicePagina+4" class="post col-xl-6">
            <div class="post-thumbnail"><img src={{fotoRuta}}{{personas[indicePagina+3]?.foto}} alt="..." class="img-fluid"></div>
            <div class="post-details">
              <div class="post-meta d-flex justify-content-between">
                <div class="date meta-last">{{personas[indicePagina+3]?.fechaInicio | date:'dd/MM/yyyy' }}</div>
              </div><a (click)="setearFiltro(personas[(indicePagina+3)]?.nombres,personas[(indicePagina+3)]?.apellidos,personas[(indicePagina+3)]?._id )">
                <h3 class="h4">{{personas[indicePagina+3]?.nombres | uppercase }},{{personas[indicePagina+3]?.apellidos | uppercase }} </h3></a>
              <p class="text-muted">{{personas[indicePagina+3]?.titulos}}</p>
            </div>
          </div>
        </div>
        <!-- Pagination de las excavaciones resumidas-->
        <nav aria-label="Page navigation example">
            <div class="pagination pagination-template d-flex justify-content-center">
              <pagination [totalItems]="personas.length" [itemsPerPage]="4" [(ngModel)]="currentPage"
              (pageChanged)="pageChanged($event)" previousText="&lsaquo;" nextText="&rsaquo;" ></pagination>
            </div>
        </nav>
      </div>         
    </main>
    <!--LO QUE VA EN EL LATERAL....-->
    <!-- Widget [Busqueda de persona]-->
    <aside class="col-lg-4" *ngIf="personas.length > 0" >
        <div class="widget search" *ngIf=mostrarTodas>
            <header>
                <h3 class="h6">Busqueda de Personal</h3>
            </header>
            <div  class="search-form" >
                <div class="form-group">
                    <input type="search" placeholder="Busca por Nombres" [(ngModel)]= filtrado.nombres name="filtroNombres">
                    <input type="search" placeholder="Busca por Apellidos" [(ngModel)]= filtrado.apellidos name="filtroApellidos">
                    <input type="search" placeholder="Busca por Nro de Documento: sin puntos" [(ngModel)]= filtrado.dni name="filtroDni">
                    <button type="submit" class="submit" (click)="mostrarPersona()"><i class="icon-search"></i></button> 
                </div>
              </div>          
        </div>
        <div class="widget search" *ngIf=!mostrarTodas>
            <header>
                <h3 class="h6">Mostrar Todas las Personas</h3>
            </header>
            <div action="#" class="search-form">
                <div class="form-group">
                <input type="text" placeholder="Haga click en la lupa" readonly>
                <button type="submit" class="submit" (click)="mostrarPersona()"><i class="icon-search"></i></button>
                </div>
            </div>
        </div>
        <!-- Widget [Lista de Personas Ordenada alfabeticamente]-->
        <div class="widget categories" *ngIf="(mostrarTodas && personas.length >0 )" >
          <header>
            <h3 class="h6">Personal del Museo: </h3>
          </header>
          <div  *ngFor="let persona of personas | orderBy:['nombres'] ">
            <div class="item d-flex justify-content-between" ><a (click)="setearFiltro(persona.nombres, persona.apellidos, persona._id)" >{{persona.nombres}}, {{persona.apellidos}}</a></div>
            <h6>  </h6>
            <!--<div class="item d-flex justify-content-between"><a href="#">{{persona.nombres | uppercase }}, {{personas.apellidos | uppercase }}</a></div>-->
          </div>
        </div>
        <div  class="widget latest-posts" *ngIf="!mostrarTodas &&  (personas | filterBy:filtrado ).length == 1 && excaPaleo.length > 0">
          <header>
            <h3 class="h6">Excavaciones donde es Paleontologo:</h3>
          </header> 
          <div class="blog-posts" >
              <div class="item d-flex align-items-center" *ngFor="let exca of excaPaleo | orderBy:['nombre']">
                <div class="image"><a href={{rutaExca}}{{exca._id}}{{exca.fotosExcavacion[0]}} data-fancybox="gallery" class="image">
                  <img src={{rutaExca}}{{exca._id}}{{exca.fotosExcavacion[0]}} alt="..." class="img-fluid"></a>
                </div>
                  <div class="title"><strong>{{exca.nombre | uppercase }}</strong>
                    <div class="d-flex align-items-center">  
                      <div class="date"><a (click)="openModal(templateExca)" ><i class="icon-clock"></i> Fecha inicio: {{exca.fechaInicio | date:'dd/MM/yyyy' }}
                        <ng-template #templateExca>
                          <div class="modal-header">
                            <h4 class="modal-title pull-left">Exavación Código:{{exca.codigo}}</h4>
                            <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
                              <span aria-hidden="true">&times;</span>
                            </button>
                          </div>
                          <div class="modal-body">
                            <li><strong>Area: </strong>{{exca.area}}</li>
                            <li><strong>Localidad: </strong> {{exca.localidad}} </li>
                            <li><strong>Provincia: </strong>{{exca.provincia}} </li>
                          </div>
                        </ng-template>
                        </a>
                      </div>
                    </div>
                  </div>
              </div>
          </div>
        </div>
        <div  class="widget latest-posts" *ngIf="!mostrarTodas &&  (personas | filterBy:filtrado ).length == 1 && excaColec.length > 0">
          <header>
            <h3 class="h6">Excavaciones donde es Colector:</h3>
          </header> 
          <div class="blog-posts" >
              <div class="item d-flex align-items-center" *ngFor="let exca of excaColec | orderBy:['nombre']">
                <div class="image"><a href={{rutaExca}}{{exca._id}}{{exca.fotosExcavacion[0]}} data-fancybox="gallery" class="image">
                  <img src={{rutaExca}}{{exca._id}}{{exca.fotosExcavacion[0]}} alt="..." class="img-fluid"></a>
                </div>
                  <div class="title"><strong>{{exca.nombre | uppercase }}</strong>
                    <div class="d-flex align-items-center">  
                      <div class="date"><a (click)="openModal(templateExca)" ><i class="icon-clock"></i> Fecha inicio: {{exca.fechaInicio | date:'dd/MM/yyyy' }}
                        <ng-template #templateExca>
                          <div class="modal-header">
                            <h4 class="modal-title pull-left">Exavación Código:{{exca.codigo}}</h4>
                            <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
                              <span aria-hidden="true">&times;</span>
                            </button>
                          </div>
                          <div class="modal-body">
                            <li><strong>Area: </strong>{{exca.area}}</li>
                            <li><strong>Localidad: </strong> {{exca.localidad}} </li>
                            <li><strong>Provincia: </strong>{{exca.provincia}} </li>
                          </div>
                        </ng-template>
                        </a>
                      </div>
                    </div>
                  </div>
              </div>
          </div>
        </div>        
    </aside>
  </div>
</div>
